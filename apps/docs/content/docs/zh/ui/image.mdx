---
title: Image
description: React 圖片元件，支援載入狀態和 fallback
---

用於處理圖片載入狀態的複合元件，提供圖片載入時的 fallback UI 和錯誤處理。

## 安裝

<Tabs items={['npm', 'pnpm', 'yarn', 'bun']}>
  <Tab value="npm">
    ```bash
    npm install @chiastack/ui
    ```
  </Tab>
  <Tab value="pnpm">
    ```bash
    pnpm add @chiastack/ui
    ```
  </Tab>
  <Tab value="yarn">
    ```bash
    yarn add @chiastack/ui
    ```
  </Tab>
  <Tab value="bun">
    ```bash
    bun add @chiastack/ui
    ```
  </Tab>
</Tabs>

## 基本用法

```tsx
import { Image } from '@chiastack/ui/image';

function Avatar() {
  return (
    <Image.Root>
      <Image.Resource src="/avatar.png" alt="User avatar" />
      <Image.Fallback>載入中...</Image.Fallback>
    </Image.Root>
  );
}
```

## 元件

### Image.Root

管理圖片載入狀態的容器元件。

**Props:**
- `status?: ImageLoadingStatus` - 初始載入狀態
- `onStatusChange?: (status: ImageLoadingStatus) => void` - 狀態變化回調
- 所有標準 `span` HTML 屬性

### Image.Resource

處理載入的實際圖片元素。

**Props:**
- `onLoadingStatusChange?: (status: ImageLoadingStatus) => void` - 載入狀態變化回調
- 所有標準 `img` HTML 屬性

### Image.Fallback

圖片載入中或發生錯誤時顯示的 fallback 內容。

**Props:**
- `delay?: number` - 顯示 fallback 前的延遲時間（毫秒）
- 所有標準 `span` HTML 屬性

## 載入狀態

`ImageLoadingStatus` 提供以下狀態：

- `idle` - 初始狀態
- `loading` - 圖片載入中
- `loaded` - 圖片載入成功
- `error` - 圖片載入失敗

## 進階用法

### 使用延遲

```tsx
import { Image } from '@chiastack/ui/image';

function Avatar() {
  return (
    <Image.Root>
      <Image.Resource src="/avatar.png" alt="User avatar" />
      <Image.Fallback delay={500}>
        <Spinner />
      </Image.Fallback>
    </Image.Root>
  );
}
```

### 使用狀態回調

```tsx
import { Image, ImageLoadingStatus } from '@chiastack/ui/image';

function Avatar() {
  const handleStatusChange = (status: ImageLoadingStatus) => {
    console.log('Image status:', status);
  };

  return (
    <Image.Root onStatusChange={handleStatusChange}>
      <Image.Resource src="/avatar.png" alt="User avatar" />
      <Image.Fallback>載入中...</Image.Fallback>
    </Image.Root>
  );
}
```

## Hooks

### useImageContext

在子元件中存取圖片上下文。

```tsx
import { useImageContext } from '@chiastack/ui/image';

function CustomComponent() {
  const { status, onStatusChange } = useImageContext();
  // 根據 status 條件渲染 UI
}
```

### useImageLoadingStatus

追蹤指定圖片來源的載入狀態的 hook。

```tsx
import { useImageLoadingStatus } from '@chiastack/ui/image';

function CustomImage({ src }: { src: string }) {
  const status = useImageLoadingStatus(src);
  // 回傳 'idle' | 'loading' | 'loaded' | 'error'
}
```

