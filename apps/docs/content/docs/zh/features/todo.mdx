---
title: Todo
description: 待辦事項管理功能
---

`@chiastack/features/todo` 提供了一個完整的待辦事項管理狀態管理解決方案，基於 Zustand 構建。

## 安裝

```bash
npm install @chiastack/features
```

## 匯入

```typescript
import { TodoStoreProvider, useTodoStore } from '@chiastack/features/todo/store';
```

## 基本使用

### 1. 設定 Provider

首先，在應用程式的根元件或需要使用的區域包裹 `TodoStoreProvider`：

```typescript
import { TodoStoreProvider } from '@chiastack/features/todo/store';

function App() {
  return (
    <TodoStoreProvider>
      <YourComponent />
    </TodoStoreProvider>
  );
}
```

### 2. 使用 Store

在元件中使用 `useTodoStore` Hook 來存取和操作待辦事項：

```typescript
import { useTodoStore } from '@chiastack/features/todo/store';

function TodoList() {
  // 取得待辦事項列表
  const todos = useTodoStore((state) => state.items);
  
  // 取得操作方法
  const addTodo = useTodoStore((state) => state.addTodo);
  const removeTodo = useTodoStore((state) => state.removeTodo);
  const toggleTodo = useTodoStore((state) => state.toggleTodo);
  const updateTodo = useTodoStore((state) => state.updateTodo);
  const clearTodos = useTodoStore((state) => state.clearTodos);
  const resetTodos = useTodoStore((state) => state.resetTodos);

  return (
    <div>
      <h1>待辦事項</h1>
      {todos.map((todo) => (
        <div key={todo.id}>
          <input
            type="checkbox"
            checked={todo.completed}
            onChange={() => toggleTodo(todo.id)}
          />
          <span>{todo.text}</span>
          <button onClick={() => removeTodo(todo.id)}>刪除</button>
        </div>
      ))}
      <button onClick={() => addTodo('新任務')}>新增任務</button>
      <button onClick={clearTodos}>清除所有</button>
    </div>
  );
}
```

## API 參考

### TodoStoreProvider

提供 Todo Store 的 Context Provider。

#### Props

```typescript
interface TodoStoreProviderProps {
  children: React.ReactNode;
  initialState?: Partial<InitialState>;
}
```

- `children`: React 子元件
- `initialState`: 可選的初始狀態，用於覆蓋預設值

#### 範例

```typescript
<TodoStoreProvider initialState={{ items: [{ id: '1', text: '初始任務', completed: false }] }}>
  <YourComponent />
</TodoStoreProvider>
```

### useTodoStore

用於存取和操作 Todo Store 的 Hook。

#### 語法

```typescript
const value = useTodoStore<T>(selector, name?);
```

- `selector`: 選擇器函式，用於從 store 中選取需要的資料
- `name`: 可選的錯誤訊息名稱（預設為 "useTodoStore"）

#### 範例

```typescript
// 取得所有待辦事項
const todos = useTodoStore((state) => state.items);

// 取得已完成數量
const completedCount = useTodoStore((state) => 
  state.items.filter((item) => item.completed).length
);

// 取得操作方法
const addTodo = useTodoStore((state) => state.addTodo);
```

### State

```typescript
interface InitialState {
  items: Todo[];
}

interface Todo {
  id: string;
  text: string;
  completed: boolean;
}
```

### Actions

#### addTodo

新增一個待辦事項。

```typescript
addTodo: (text: string) => void;
```

**範例：**

```typescript
addTodo('完成文件撰寫');
```

#### removeTodo

移除指定的待辦事項。

```typescript
removeTodo: (id: string) => void;
```

**範例：**

```typescript
removeTodo('todo-id-123');
```

#### toggleTodo

切換待辦事項的完成狀態。

```typescript
toggleTodo: (id: string) => void;
```

**範例：**

```typescript
toggleTodo('todo-id-123');
```

#### updateTodo

更新待辦事項的文字內容。

```typescript
updateTodo: (id: string, text: string) => void;
```

**範例：**

```typescript
updateTodo('todo-id-123', '更新後的任務內容');
```

#### clearTodos

清除所有待辦事項。

```typescript
clearTodos: () => void;
```

**範例：**

```typescript
clearTodos();
```

#### resetTodos

重置待辦事項列表為指定的項目。

```typescript
resetTodos: (items: Todo[]) => void;
```

**範例：**

```typescript
resetTodos([
  { id: '1', text: '任務一', completed: false },
  { id: '2', text: '任務二', completed: true },
]);
```

## 完整範例

```typescript
import { useState } from 'react';
import { TodoStoreProvider, useTodoStore } from '@chiastack/features/todo/store';

function App() {
  return (
    <TodoStoreProvider>
      <TodoApp />
    </TodoStoreProvider>
  );
}

function TodoApp() {
  const [input, setInput] = useState('');
  
  const todos = useTodoStore((state) => state.items);
  const addTodo = useTodoStore((state) => state.addTodo);
  const removeTodo = useTodoStore((state) => state.removeTodo);
  const toggleTodo = useTodoStore((state) => state.toggleTodo);
  const clearTodos = useTodoStore((state) => state.clearTodos);

  const handleAdd = () => {
    if (input.trim()) {
      addTodo(input);
      setInput('');
    }
  };

  const completedCount = todos.filter((todo) => todo.completed).length;
  const totalCount = todos.length;

  return (
    <div>
      <h1>待辦事項 ({completedCount}/{totalCount})</h1>
      
      <div>
        <input
          value={input}
          onChange={(e) => setInput(e.target.value)}
          onKeyPress={(e) => e.key === 'Enter' && handleAdd()}
          placeholder="輸入新任務..."
        />
        <button onClick={handleAdd}>新增</button>
        <button onClick={clearTodos}>清除所有</button>
      </div>

      <ul>
        {todos.map((todo) => (
          <li key={todo.id}>
            <input
              type="checkbox"
              checked={todo.completed}
              onChange={() => toggleTodo(todo.id)}
            />
            <span style={{ textDecoration: todo.completed ? 'line-through' : 'none' }}>
              {todo.text}
            </span>
            <button onClick={() => removeTodo(todo.id)}>刪除</button>
          </li>
        ))}
      </ul>
    </div>
  );
}
```

## 注意事項

- `useTodoStore` 必須在 `TodoStoreProvider` 內部使用，否則會拋出錯誤
- Store 使用 Zustand 的 DevTools 整合，可以在開發時使用 Redux DevTools 進行除錯
- 每個待辦事項都會自動生成唯一的 ID（使用 nanoid）

