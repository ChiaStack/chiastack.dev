---
title: Utils
description: Utility functions
---

`@chiastack/features/utils` provides a series of practical utility functions to support the development and usage of feature modules.

## Installation

```bash
npm install @chiastack/features
```

## Modules

### UUID

Provides UUID and NanoID generation functionality.

#### Import

```typescript
import { nanoid, uuid, createNanoId } from '@chiastack/features/utils/uuid';
```

#### API

**nanoid**

Generate a short ID (default 8 characters).

```typescript
const id = nanoid(); // e.g., "a1b2c3d4"
```

**uuid**

Generate a standard UUID v4.

```typescript
import { uuid } from '@chiastack/features/utils/uuid';

const id = uuid(); // e.g., "550e8400-e29b-41d4-a716-446655440000"
```

**createNanoId**

Create a custom-length NanoID generator.

```typescript
import { createNanoId } from '@chiastack/features/utils/uuid';

const customId = createNanoId(16); // Create a 16-character ID generator
const id = customId(); // Generate a 16-character ID
```

#### Example

```typescript
import { nanoid, uuid } from '@chiastack/features/utils/uuid';

// Use nanoid for short IDs (suitable for UI component keys)
const todoId = nanoid();

// Use uuid for standard UUIDs (suitable for database primary keys)
const userId = uuid();
```

### Logger

Provides conditional logging functionality with support for controlling log output via URL parameters in development environments.

#### Import

```typescript
import { logger, log, error, warn, info, debug } from '@chiastack/features/utils/logger';
```

#### API

**logger**

Generic logging function.

```typescript
logger(message?, options?);
```

**Parameters:**
- `message`: Message to log (can be any type or array)
- `options`: Options object
  - `type`: Log type ('log' | 'error' | 'warn' | 'info' | 'debug', defaults to 'log')
  - `enabled`: Whether to enable logging (defaults to checking URL parameter `?debug=true`)

**Convenience Functions:**

- `log()`: Log general messages
- `error()`: Log errors
- `warn()`: Log warnings
- `info()`: Log information
- `debug()`: Log debug information

#### Example

```typescript
import { log, error, warn, info, debug } from '@chiastack/features/utils/logger';

// Basic usage (only outputs when URL contains ?debug=true)
log('This is a general log');
error('This is an error');
warn('This is a warning');
info('This is info');
debug('This is debug info');

// Force enable logging
log('Force output', { enabled: true });

// Log arrays
log(['Item 1', 'Item 2', 'Item 3']);

// Log objects
log({ key: 'value', count: 42 });
```

**Usage Scenario:**

During development, you can add `?debug=true` to the browser URL to enable log output:

```
http://localhost:3000?debug=true
```

### Stream

Provides stream data processing functionality for handling Server-Sent Events (SSE) or other stream responses.

#### Import

```typescript
import { fetchStream } from '@chiastack/features/utils/stream';
```

#### API

**fetchStream**

Fetch a stream response from the specified URL.

```typescript
fetchStream<T>(input, payload, init?);
```

**Parameters:**
- `input`: Request URL or Request object
- `payload`: Data payload for POST request
- `init`: Optional request initialization options
  - `searchParams`: URL query parameters object
  - Other standard `RequestInit` options

**Return Value:**

Returns an iterable object containing:
- `[Symbol.asyncIterator]`: Async iterator
- `stream`: Raw ReadableStream

#### Example

```typescript
import { fetchStream } from '@chiastack/features/utils/stream';

// Basic usage
const stream = await fetchStream('/api/chat/stream', {
  message: 'Hello',
  threadId: 'thread-123',
});

// Iterate stream data
for await (const chunk of stream) {
  console.log('Received data:', chunk);
  // Process each data chunk
}

// Use query parameters
const streamWithParams = await fetchStream(
  '/api/chat/stream',
  { message: 'Hello' },
  {
    searchParams: {
      format: 'json',
      version: 'v1',
    },
  }
);

for await (const chunk of streamWithParams) {
  console.log(chunk);
}
```

**Error Handling:**

```typescript
try {
  const stream = await fetchStream('/api/stream', { data: 'test' });
  
  for await (const chunk of stream) {
    // Process data
  }
} catch (err) {
  console.error('Stream request failed:', err);
}
```

### StoreDebug

Provides store debugging functionality (advanced use).

#### Import

```typescript
import { storeDebug } from '@chiastack/features/utils/storeDebug';
```

### Middleware

Provides Zustand middleware functionality.

#### Import

```typescript
import { createDevtools } from '@chiastack/features/utils/middleware/create-devtools';
```

#### createDevtools

Create Redux DevTools middleware.

```typescript
createDevtools(name, options?);
```

**Parameters:**
- `name`: Store name (for DevTools display)
- `options`: Options object
  - `enabled`: Whether to enable DevTools

**Example:**

```typescript
import { createDevtools } from '@chiastack/features/utils/middleware/create-devtools';
import { createStore } from 'zustand/vanilla';

const devtools = createDevtools('MyStore', { enabled: true });

const store = createStore(
  devtools((set) => ({
    count: 0,
    increment: () => set((state) => ({ count: state.count + 1 })),
  }))
);
```

## Complete Example

```typescript
import { nanoid } from '@chiastack/features/utils/uuid';
import { log, error } from '@chiastack/features/utils/logger';
import { fetchStream } from '@chiastack/features/utils/stream';

// Generate ID
const todoId = nanoid();
log('Generated ID:', todoId);

// Process stream
async function handleStream() {
  try {
    const stream = await fetchStream('/api/data/stream', {
      action: 'fetch',
    });

    for await (const chunk of stream) {
      log('Received data:', chunk);
      // Process data
    }
  } catch (err) {
    error('Stream processing failed:', err);
  }
}
```

## Notes

- `logger` function only outputs in development environment and when URL contains `?debug=true` by default
- `fetchStream` uses POST method by default unless specified otherwise in `init`
- `nanoid` uses a non-secure custom alphabet, suitable for UI scenarios
- `uuid` uses standard UUID v4 format, suitable for databases or APIs

